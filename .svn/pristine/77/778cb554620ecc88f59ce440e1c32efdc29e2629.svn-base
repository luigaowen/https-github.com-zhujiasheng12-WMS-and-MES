<!DOCTYPE html>
<html style="height:100%">
<head>
    <meta charset="utf-8" />
    <title></title>

    <script src="../../Resources/js/echarts.js"></script>

    <script src="../../Resources/js/layui-v2.5.4/layui/layui.js"></script>

    <link href="../resource/layui.css" rel="stylesheet" />

    <script src="../../Resources/js/jquery-3.3.1.js"></script>
    <script src="../../Resources/js/jquery.cookie.js"></script>
     <script src="/Resources/js/bootstrap-4.3.1-dist/js/bootstrap.min.js"></script>
    <link href="/Resources/js/bootstrap-4.3.1-dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="/Resources/js/vue.min.js"></script>
    <style>
        ::-webkit-scrollbar
        { /*滚动条整体样式*/
            width: 4px; /*高宽分别对应横竖滚动条的尺寸*/
            height: 4px;
            scrollbar-arrow-color: red;
        }

        ::-webkit-scrollbar-thumb
        { /*滚动条里面小方块*/
            border-radius: 5px;
            -webkit-box-shadow: inset 0 0 5px rgba(0,0,0,0.2);
            background: rgba(0,0,0,0.2);
            scrollbar-arrow-color: red;
        }

        ::-webkit-scrollbar-track
        { /*滚动条里面轨道*/
            -webkit-box-shadow: inset 0 0 5px rgba(0,0,0,0.2);
            border-radius: 0;
            background: rgba(0,0,0,0.1);
        }
    </style>

</head>
<body style="height:96%;background-color:black;padding:10px;">
    <input id="workId" hidden />
    <!--#19201E-->

    <div class="layui-row " style="height:95%">
        <div class="layui-col-md5"style="height:100%">
            
             <div class="layui-card" style="background-color:black;height:100%">
                    <div class="layui-card-header" style="font-size:130%;height:30px;background-color:rgba(128,128,128,0.3);width:20%;border-bottom:hidden;border-radius:10px 30px 0 0;color:white">机台生产状态</div>

                    <div id="cncLayout" class="layui-card-body" style="text-align:center;position:absolute;top:30px;right:10px;bottom:-10px;left:0px;background-color:rgba(128,128,128,0.3)">
                   
                    </div>
                </div>
        </div>

          <div class="layui-col-md7" style="height:100%">
            <div class="layui-row" style="height:32.5%">
                   <div class="layui-col-md12" style="height:100%;margin-bottom:10px">
                <div class="layui-card" style="background-color:black;height:100%">
                    <div class="layui-card-header" style="float:left;width:200px;height:30px;background-color:rgba(128,128,128,0.3);border-bottom:none;border-radius:10px 30px 0 0;font-size:130%;color:white">
                        车间机台状态

                    </div>
                    <div id="workName" class="layui-card-header" style="float:left;margin-left:30%;width:15%;height:30px;background-color:black;border-bottom:none;border-radius:10px 30px 0 0;font-size:130%;color:white">
                     <!--  加载中...-->

                    </div>
                    <div class="layui-card-body" style="background-color:rgba(128,128,128,0.3); position: absolute;top:30px;bottom:0;left:0;right:-10px;color:white">
                        <div style="height:100%;width:100%;padding-top:50px;margin:15px auto">

                          


                                <div style="width:12.5%;height:100%;float:left"><div style="font-size:130%;text-align:center">总数</div><div style="font-size:200%;text-align:center;margin-top:30px " id="deviceAllNum">0</div></div>
                                <div style="width:12.5%;height:100%;float:left"><div style="font-size:130%;text-align:center"> 运行</div><div style="font-size:200%;color:#5FB878;text-align:center;margin-top:30px" id="RunNum">0</div></div>
                                
                            <div style="width:12.5%;height:100%;float:left"><div style="font-size:130%;text-align:center">暂停</div><div style="font-size:200%;color:orange;text-align:center;margin-top:30px" id="yellow">0</div></div>

                         
                                <div style="width:12.5%;height:100%;float:left"><div style="font-size:130%;text-align:center">报警</div><div style="font-size:200%;color:red;text-align:center;margin-top:30px" id="AlarmNum">0</div></div>
<div style="width:12.5%;height:100%;float:left"><div style="font-size:130%;text-align:center">停机</div><div style="font-size:200%;text-align:center;margin-top:30px" id="gray">0</div></div>
                                <div style="width:12.5%;height:100%;float:left"><div style="font-size:130%;text-align:center"> 维修</div><div style="font-size:200%;color:white;text-align:center;margin-top:30px" id="RepairNum">0</div></div>
                                <div style="width:12.5%;height:100%;float:left"><div style="font-size:130%;text-align:center"> 待料</div><div style="font-size:200%;color:white;text-align:center;margin-top:30px" id="StopNum">0</div></div>
 
                               <div style="width:12.5%;height:100%;float:left"><div style="font-size:130%;text-align:center"> 无单</div><div style="font-size:200%;text-align:center;margin-top:30px" id="wudan">0</div></div>

                          
                        </div>
                        </div>
                </div>

              
            </div>

            </div>
              <div class="layui-row" style="height:33%;margin-bottom:20px">
                  <div class="layui-col-md4" style="height:100%">

                       <div class="layui-card" style="background-color:black;height:100%">
                        <div class="layui-card-header" style="font-size:130%;width:200px;height:30px;background-color:rgba(128,128,128,0.3);border-bottom:none;border-radius:10px 30px 0 0;color:white">车间稼动/达成率</div>
                        <div class="layui-card-body" style="background-color:rgba(128,128,128,0.3);position: absolute;top:30px;bottom:0;left:0px;right:10px;color:white">
                            <div id="time" style="width:50%;height:100%;float:left"></div>
                            <div id="performance" style="width:50%;height:100%;float:left"></div>
                          
                        </div>
                    </div>
                  </div>
                   <div class="layui-col-md4" style="height:100%">


                        <div class="layui-card" style="background-color:black;height:100%">
                        <div class="layui-card-header" style="font-size:130%;width:200px;height:40px;background-color:rgba(128,128,128,0.3);border-bottom:none;border-radius:10px 30px 0 0;color:white">TOP机床稼动率</div>
                        <div class="layui-card-body" style="background-color:rgba(128,128,128,0.3);position: absolute;top:40px;bottom:0;left:0px;right:10px;color:white;padding:0 10px 0 10px">
                            <table id="demo5" lay-filter="test" class="table" style="background-color:white">

                                 <thead>
                                 <tr style="background-color:rgba(0, 0, 0, 0.8)">
                                     <th :style="style">机床</th>
                                      <th :style="style">稼动率</th>
                                   
                                     
                                 </tr>
                            </thead>
                            <tbody>
                                <tr v-for="item in list" v-if="item.cncNum==''?false:true">
                                    <td :style="style">
                                        {{item.cncNum}}
                                    </td>
                                     <td :style="style">

                                         <div v-if="item.cncNum==''?false:true" class="progress progress-striped active">
	<div class="progress-bar progress-bar-success" role="progressbar"
		 aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
		:style="{width:(item.progress*100).toString()+'%'}">
		<span class="">{{(item.progress*100).toString()+'%'}}</span>
	</div>
</div>

                                        
                                        
                                    </td>
                                    
                                </tr>
                            </tbody>

                            </table>
                        </div>
                    </div>

                  </div>
                   <div class="layui-col-md4" style="height:100%">



                          <div class="layui-card" style="background-color:black;height:100%">
                            <div class="layui-card-header" style="font-size:130%;width:200px;height:30px;background-color:rgba(128,128,128,0.3);border-bottom:none;border-radius:10px 30px 0 0;color:white">TOP待料状态</div>
                            <div class="layui-card-body" style="background-color:rgba(128,128,128,0.3);position: absolute;top:30px;bottom:0;left:0px;right:0px;color:white;">
                                <table id="demo1" lay-filter="test" class="table" style="background-color:white">

                                    
                                 <thead>
                                 <tr style="background-color:rgba(0, 0, 0, 0.8)">
                                     <th :style="style">机床</th>
                                      <th :style="style">待料时长</th>
                                    <th :style="style">毛坯信息</th>
                                     
                                 </tr>
                            </thead>
                            <tbody>
                                <tr v-for="item in list" v-if="item.cncNum==''?false:true">
                                    <td :style="style">
                                        {{item.cncNum}}
                                    </td>
                                     <td :style="style">

                                         <div v-if="item.progress==''?false:true" class="progress progress-striped active">
	<div class="progress-bar progress-bar-success" role="progressbar"
		 aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
		:style="{width:(item.progress*100).toString()+'%'}">
		<span class="">{{item.time}}</span>
	</div>
</div>

                                        
                                        
                                    </td>
                                     <td :style="style">
                                        {{item.startTime}}
                                    </td>
                                </tr>
                            </tbody>

                                </table>
                            </div>
                        </div>

                  </div>
              </div>


               <div class="layui-row" style="height:33%">
                  <div class="layui-col-md4" style="height:100%">


                        <div class="layui-card" style="background-color:black;height:100%">
                            <div class="layui-card-header" style="font-size:130%;width:200px;height:30px;background-color:rgba(128,128,128,0.3);border-bottom:none;border-radius:10px 30px 0 0;color:white">TOP停机预估情况</div>
                            <div class="layui-card-body" style="background-color:rgba(128,128,128,0.3);position: absolute;top:30px;bottom:0;left:0px;right:10px;color:white;">
                                <table id="demo2" lay-filter="test" class="table" style="background-color:white">

                                    
                                 <thead>
                                 <tr style="background-color:rgba(0, 0, 0, 0.8)">
                                     <th :style="style">机床</th>
                                      <th :style="style">时长</th>
                                   
                                       <th :style="style">预计停机时间</th>
                                 </tr>
                            </thead>
                            <tbody>
                                <tr v-for="item in list" v-if="item.cncNum==''?false:true">
                                    <td :style="style">
                                        {{item.cncNum}}
                                    </td>
                                     <td :style="style">

                                         <div v-if="item.progress==''?false:true" class="progress progress-striped active">
	<div class="progress-bar progress-bar-success" role="progressbar"
		 aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
		:style="{width:(item.progress*100).toString()+'%'}">
		<span class="">{{item.time}}</span>
	</div>
</div>

                                        
                                        
                                    </td>
                                    <td :style="style">
                                        {{item.stopTime}}
                                    </td>
                                </tr>
                            </tbody>
                                </table>
                            </div>
                        </div>

                  </div>
                   <div class="layui-col-md4" style="height:100%">


                             <div class="layui-card" style="background-color:black;height:100%">
                            <div class="layui-card-header" style="font-size:130%;width:200px;height:30px;background-color:rgba(128,128,128,0.3);border-bottom:none;border-radius:10px 30px 0 0;color:white">TOP待装刀情况</div>
                            <div class="layui-card-body" style="background-color:rgba(128,128,128,0.3);position: absolute;top:30px;bottom:0;left:0px;right:10px;color:white;">
                                <table id="demo3" lay-filter="test" class="table" style="background-color:white">

                                    
                                 <thead>
                                 <tr style="background-color:rgba(0, 0, 0, 0.8)">
                                     <th :style="style">机床</th>
                                      <th :style="style">超时时长</th>
                                   
                                      <th :style="style">刀号</th>
                                 </tr>
                            </thead>
                            <tbody>
                                <tr v-for="item in list" v-if="item.cncNum==''?false:true">
                                    <td :style="style">
                                        {{item.cncNum}}
                                    </td>
                                     <td :style="style">

                                         <div v-if="item.progress==''?false:true" class="progress progress-striped active">
	<div class="progress-bar progress-bar-success" role="progressbar"
		 aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
		:style="{width:(item.progress*100).toString()+'%'}">
		<span class="">{{item.time}}</span>
	</div>
</div>

                                        
                                        
                                    </td>
                                    <td :style="style">
                                        {{item.toolNum}}
                                    </td>
                                </tr>
                            </tbody>
                                </table>
                               
                            </div>
                        </div>


                  </div>
                   <div class="layui-col-md4" style="height:100%">



                         <div class="layui-card" style="background-color:black;height:100%">
                            <div class="layui-card-header" style="font-size:130%;width:200px;height:30px;background-color:rgba(128,128,128,0.3);border-bottom:none;border-radius:10px 30px 0 0;color:white">TOP机台维修情况</div>
                            <div class="layui-card-body" style="background-color:rgba(128,128,128,0.3);position: absolute;top:30px;bottom:0;left:0px;right:0;color:white;">
                                <table id="demo4" lay-filter="test" class="table" style="background-color:white">

                                    
                                 <thead>
                                 <tr style="background-color:rgba(0, 0, 0, 0.8)">
                                     <th :style="style">机床</th>
                                      <th :style="style">维修时长</th>
                                   <th :style="style">报修时间</th>
                                     
                                 </tr>
                            </thead>
                            <tbody >
                                <tr v-for="item in list" v-if="item.cncNum==''?false:true">
                                    <td :style="style">
                                        {{item.cncNum}}
                                    </td>
                                     <td :style="style" >

                                         <div v-if="item.progress==''?false:true" class="progress progress-striped active">
	<div class="progress-bar progress-bar-success" role="progressbar"
		 aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
		:style="{width:(item.progress*100).toString()+'%'}">
		<span class="">{{item.time}}</span>
	</div>
</div>

                                        
                                        
                                    </td>
                                    <td :style="style">
                                        {{item.startTime}}
                                    </td>
                                </tr>
                            </tbody>
                                </table>
                            </div>
                        </div>

                  </div>
              </div>


        </div>

    </div>
  
   
        <script>
             workId = $.cookie('workId');
        
      
            //根据workId获取车间名
            //$.ajax({
            //    url: "读取车间名.ashx",
            //    data: { "workId": workId },
            //    success: function (d) {
            //        $("#workName").text(d)
            //    }
            //})
            var src='../../工厂管理/设计布局图/' + workId + '.svg'
            $("#cncLayout").append('<iframe style="width:100%;height:100%" src="'+src+'" frameborder="0"></iframe>')
            var t1 = setInterval('fun10()', 100);
            var t2 = setTimeout('layoutFill()', 10);
            function fun10() {
                if ($($("iframe")[0].contentDocument).find("#svg").length > 0) {
                      $($("iframe")[0].contentDocument).find("#svg").on('mousewheel DOMMouseScroll', iframeZoom);
                     clearInterval(t1);   
                }
       
            }

           
 
            function layoutFill() {
                if ($($("iframe")[0].contentDocument).find("#svg").length > 0) {
                   
                    var zoom = $($("iframe")[0].contentDocument).find("#svg").css("zoom");
                    var height = $($("iframe")[0].contentDocument).find("#svg").attr("height");
                    var width = $($("iframe")[0].contentDocument).find("#svg").attr("width");
                    var svgHeight = Number(height) * Number(zoom)
                    var svgWidth = Number(width) * Number(zoom)
                    var iframeHeight = $("iframe")[0].clientHeight
                    var iframeWidth = $("iframe")[0].clientWidth
                    if (svgWidth >= iframeWidth|svgHeight>=iframeHeight) {
                      
                        $($("iframe")[0].contentDocument).find("#svg").css('zoom', Number(zoom) - 0.01)
                        setTimeout('layoutFill()', 10);
                    } else {
                        if (Number(width) * Number(zoom+0.01)< iframeWidth&Number(height) * Number(zoom+0.01)<iframeHeight) {
                               $($("iframe")[0].contentDocument).find("#svg").css('zoom', Number(zoom) +0.01)
                        setTimeout('layoutFill()', 10);
                        }
                    }

                }
                else {
                    setTimeout('layoutFill()', 10);
                }
            }
              function iframeZoom(e) {
            var id=this.id
    e.preventDefault();
    var wheel = e.originalEvent.wheelDelta || -e.originalEvent.detail;
    var delta = Math.max(-1, Math.min(1, wheel) );
        if (delta < 0) {//向下滚动
           //var ss= $($("iframe")[0].contentDocument).find("#svg")
            var zoom = $($("iframe")[0].contentDocument).find("#svg").css('zoom')
            $($("iframe")[0].contentDocument).find("#svg").css('zoom', Number(zoom)-0.1)
            
       
        } else {//向上滚动
            var zoom = $($("iframe")[0].contentDocument).find("#svg").css('zoom')
            $($("iframe")[0].contentDocument).find("#svg").css('zoom', Number(zoom)+0.1)
    } 
              }





              if (typeof (EventSource) != "undefined") {
                  var source = new EventSource('机台状态.ashx?workId=' + workId);
                  source.onmessage = function (event) {
                      {
                          var obj = JSON.parse(event.data)
                         
                          for (var i = 0; i < obj.length; i++) {
                              var id = obj[i].MachNum.replace("#", "")
                              switch (obj[i].state) {
                                  case 1:
                                      $($("iframe")[0].contentDocument).find("#" + id).attr('href', "绿红.png")
                                      break;
                                  case -1:
                                      $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/red.png")
                                      break;

                              }



                             
                              for (var i = 0; i < obj.length; i++) {
                                  var id = obj[i].MachID.replace("#", "")

                                  switch (obj[i].flag) {
                                      case 0:
                                          switch (obj[i].state) {
                                              case -1:
                                                  $('#' + id).attr('grayGreenRed', 'grayGreenRed')
                                                  break;
                                              case 0:
                                                  $('#' + id).attr('yellowGreenRed', 'yellowGreenRed')
                                                  break;
                                              case 1:
                                                  $('#' + id).attr('greenGreenRed', 'greenGreenRed')
                                                  break;
                                              case 2:
                                                  $('#' + id).attr('greenGreenRed', 'greenGreenRed')
                                                  break;
                                              case 3:
                                                  $('#' + id).attr('yellowGreenRed', 'yellowGreenRed')
                                                  break;
                                              case 4:
                                                  $('#' + id).attr('redGreenRed', 'redGreenRed')
                                                  break;
                                          }
                                          break;
                                      case 1:
                                          switch (obj[i].state) {
                                              case -1:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/灰绿.png")

                                                  break;
                                              case 0:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/黄绿.png")


                                                  break;
                                              case 1:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/绿绿.png")


                                                  break;
                                              case 2:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/绿绿.png")


                                                  break;
                                              case 3:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/黄绿.png")

                                                  break;
                                              case 4:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/红绿.png")

                                                  break;
                                          }
                                          break;
                                      case -1:
                                          switch (obj[i].state) {
                                              case -1:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/灰红.png")

                                                  break;
                                              case 0:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/黄红.png")

                                                  break;
                                              case 1:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/绿红.png")

                                                  break;
                                              case 2:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/绿红.png")

                                                  break;
                                              case 3:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/黄红.png")

                                                  break;
                                              case 4:
                                                  $($("iframe")[0].contentDocument).find("#" + id).attr('href', "../../Kanban/resource/机床图片/红红.png")

                                                  break;
                                          }
                                          break;
                                  }
                              }


                          }
                      
                      }
                  }

              } else {
                  alert("抱歉！不支持服务器发送事件！")
              } 





 
        </script>      
    <script>
        if (typeof (EventSource) !== "undefined") {
            var source = new EventSource("../设备监控/车间机台状态.ashx?workId="+ $.cookie('workId'));
            source.onmessage = function (event) {
                var obj = JSON.parse(event.data)
              

                $("#AlarmNum").text(obj.AlarmNum)
                $("#deviceAllNum").text(obj.deviceAllNum)
                $("#RepairNum").text(obj.RepairNum)
                $("#RunNum").text(obj.RunNum)
                var grayNumber = Number(obj.deviceAllNum) - Number(obj.AlarmNum) - Number(obj.RunNum) - Number(obj.yellow)
                $("#gray").text(grayNumber)
                $("#wudan").text("0")
                $("#yellow").text(obj.yellow)
            };
        } else {
            alert("抱歉！不支持服务器发送事件！")
        }
    </script> 
        <script type="text/javascript">
            // 基于准备好的dom，初始化echarts实例   
            var myChart = echarts.init(document.getElementById('time'));//performance
            var myChartPerformance = echarts.init(document.getElementById('performance'));//goodProductRate
       
            option1 = {
                tooltip: {
                    formatter: "{a} <br/>{b} : {c}%"
                },
                toolbox: {
                    feature: {
                        restore: {},
                        saveAsImage: {}
                    }
                },
                title: {
                    text: '稼动率',
                    left: 'center', //标题位置
                    bottom: '10%',
                    textStyle: {
                        color: "#999",
                        fontSize: 18
                    },
                },

                series: [
                    {
                        name: '稼动率',
                        type: 'gauge',
                        title: {               //设置仪表盘中间显示文字样式
                            textStyle: {       // 其余属性默认使用全局文本样式，详见TEXTSTYLE

                                color: "white"
                            }
                        },


                        axisLabel: {
                            show: false,
                            distance: -40
                        },
                        axisLine: {            // 坐标轴线
                            lineStyle: {       // 属性lineStyle控制线条样式
                                color: [[0.2, '#c23531'], [0.8, '#63869e'], [1, '#91c7ae']]
                            }
                        },

                        detail: {
                            formatter: '{value}%',
                            textStyle: {

                                "fontSize": 18,
                            }
                        },
                        data: [{ value:0, name: '', }]
                    }

                ],

            };
            option2 = {
                tooltip: {
                    formatter: "{a} <br/>{b} : {c}%"
                },
                toolbox: {
                    feature: {
                        restore: {},
                        saveAsImage: {}
                    }
                },
                title: {
                    text: '达成率',
                    left: 'center', //标题位置
                    bottom: '10%',
                    textStyle: {
                        color: "#999",
                        fontSize: 18
                    },
                },
                series: [
                    {
                        name: '达成率',
                        type: 'gauge',
                        title: {               //设置仪表盘中间显示文字样式
                            textStyle: {       // 其余属性默认使用全局文本样式，详见TEXTSTYLE

                                color: "white"
                            }
                        },


                        axisLabel: {
                            show: false,
                            distance: -40
                        },
                        axisLine: {            // 坐标轴线
                            lineStyle: {       // 属性lineStyle控制线条样式
                                color: [[0.2, '#c23531'], [0.8, '#63869e'], [1, '#91c7ae']]
                            }
                        },
                        detail: {
                            formatter: '{value}%',
                            textStyle: {

                                "fontSize": 18,
                            }
                        },
                        data: [{ value: 0, name: '', }]
                    }

                ],

            };
            myChart.setOption(option1);
            myChartPerformance.setOption(option2);

            
            if (typeof (EventSource) !== "undefined") {
                var source = new EventSource("../设备监控/稼动率.ashx");
                source.onmessage = function (event) {
                    var obj = JSON.parse(event.data)
                  
                   
                    option1.series[0].data[0].value =Number( obj.TimeC*100).toFixed(0);
                    option2.series[0].data[0].value =Number( obj.xingnnegC*100).toFixed(0);

                    myChart.setOption(option1);
                    myChartPerformance.setOption(option2);
                };
            } else {
                alert("抱歉！不支持服务器发送事件！")
            }
        </script>
        <script>
         

           




            var vm1 = new Vue({
                el: "#demo1",
                data: {
                    list: []
                    , style: { color: 'white', padding: '0.4rem', border: 'none' }


                },
                methods: {

                    fun: function () {
                        var _this = this
                        if (typeof (EventSource) !== "undefined") {
                            var source = new EventSource('../设备监控/TOP待料状态.ashx?workId=' + $.cookie('workId'));
                            source.onmessage = function (event) {
                               
                                var data = JSON.parse(event.data);
                                if (data.data[0].cncNum == "") {

                                    data.data[0].cncNum = "无数据"
                                }
                                _this.list = data.data

                            }
                        }
                    }
                },
                created: function () {


                    this.fun()
                },
                updated: function () {

                    var trs = $("#demo1").find('tbody').find('tr')
                    for (var i = 0; i < trs.length; i++) {
                        if (i % 2 == 0) {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.65)')
                        } else {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.7)')
                        }
                    }

                }
            })

            var vm2 = new Vue({
                el: "#demo2",
                data: {
                    list: []
                    , style: { color: 'white', padding: '0.4rem', border: 'none' }


                },
                methods: {

                    fun: function () {
                        var _this = this
                        if (typeof (EventSource) !== "undefined") {
                            var source = new EventSource('../设备监控/TOP停机情况.ashx?workId=' + $.cookie('workId'));
                            source.onmessage = function (event) {
                             
                                var data = JSON.parse(event.data);
                                if (data.data[0].cncNum == "") {

                                    data.data[0].cncNum = "无数据"
                                }
                                _this.list = data.data

                            }
                        }
                    }
                },
                created: function () {


                    this.fun()
                },
                updated: function () {

                    var trs = $("#demo2").find('tbody').find('tr')
                    for (var i = 0; i < trs.length; i++) {
                        if (i % 2 == 0) {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.65)')
                        } else {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.7)')
                        }
                    }

                }
            })



            var vm3 = new Vue({
                el: "#demo3",
                data: {
                    list: []
                    , style: { color: 'white', padding: '0.4rem', border: 'none' }


                },
                methods: {

                    fun: function () {
                        var _this = this
                        if (typeof (EventSource) !== "undefined") {
                            var source = new EventSource('../设备监控/TOP刀具准备情况.ashx?workId=' + $.cookie('workId'));
                            source.onmessage = function (event) {
                             
                                var data = JSON.parse(event.data);
                                console.log(data)
                                if (data.data[0].cncNum == "") {

                                    data.data[0].cncNum = "无数据"
                                }
                                _this.list = data.data

                            }
                        }
                    }
                },
                created: function () {


                    this.fun()
                },
                updated: function () {

                    var trs = $("#demo3").find('tbody').find('tr')
                    for (var i = 0; i < trs.length; i++) {
                        if (i % 2 == 0) {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.65)')
                        } else {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.7)')
                        }
                    }

                }
            })





            var vm4 = new Vue({
                el: "#demo4",
                data: {
                    list: []
                    , style: { color: 'white', padding: '0.4rem', border: 'none' }
                  

                },
                methods: {

                    fun: function () {
                        var _this = this
                        if (typeof (EventSource) !== "undefined") {
                            var source = new EventSource('../设备监控/TOP机台维修情况.ashx?workId=' + $.cookie('workId'));
                            source.onmessage = function (event) {
                               
                                var data = JSON.parse(event.data);
                             
                                if (data.data[0].cncNum == "") {
                                 
                                    data.data[0].cncNum="无数据"
                                }
                                _this.list = data.data

                            }
                        }
                    }
                },
                created: function () {


                    this.fun()
                },
                updated: function () {

                    var trs = $("#demo4").find('tbody').find('tr')
                    for (var i = 0; i < trs.length; i++) {
                        if (i % 2 == 0) {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.65)')
                        } else {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.7)')
                        }
                    }

                }
            })


           
            var vm5 = new Vue({
                el: "#demo5",
                data: {
                    list: []
                    , style: { color: 'white', padding: '0.4rem', border: 'none' }


                },
                methods: {

                    fun: function () {
                        var _this = this
                        if (typeof (EventSource) !== "undefined") {
                            var source = new EventSource('../设备监控/TOP机床稼动率.ashx?workId=' + $.cookie('workId'));
                            source.onmessage = function (event) {

                                var data = JSON.parse(event.data);
                                if (data.data[0].cncNum == "") {

                                    data.data[0].cncNum = "无数据"
                                }
                                _this.list = data.data

                            }
                        }
                    }
                },
                created: function () {


                    this.fun()
                },
                updated: function () {

                    var trs = $("#demo5").find('tbody').find('tr')
                    for (var i = 0; i < trs.length; i++) {
                        if (i % 2 == 0) {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.65)')
                        } else {
                            $(trs[i]).css('background-color', 'rgba(0, 0, 0, 0.7)')
                        }
                    }

                }
            })

          
        </script>
        <script>
        


            grayGreenRed()
            yellowGreenRed()
            greenGreenRed()
            redGreenRed()
            var grayGreenRedCount = 0;
            var yellowGreenRedCount = 0;
            var greenGreenRedCount = 0;
            var redGreenRedCount = 0;
            function grayGreenRed() {
                setInterval(function () {
                    if (grayGreenRedCount == 0) {
                        $('[grayGreenRed]').attr('src', '../resource/机床图片/灰绿.png')
                        grayGreenRedCount = 1
                    } else {
                        $('[grayGreenRed]').attr('src', '../resource/机床图片/灰灰.png')
                        grayGreenRedCount = 0;
                    }

                }, 500)

            }
            function yellowGreenRed() {
                setInterval(function () {
                    if (yellowGreenRedCount == 0) {
                        $('[yellowGreenRed]').attr('src', '../resource/机床图片/黄绿.png')
                        yellowGreenRedCount = 1
                    } else {
                        $('[yellowGreenRed]').attr('src', '../resource/机床图片/黄灰.png')
                        yellowGreenRedCount = 0;
                    }

                }, 500)
            }
            function greenGreenRed() {
                setInterval(function () {
                    if (greenGreenRedCount == 0) {
                        $('[greenGreenRed]').attr('src', '../resource/机床图片/绿绿.png')
                        greenGreenRedCount = 1
                    } else {
                        $('[greenGreenRed]').attr('src', '../resource/机床图片/绿红.png')
                        greenGreenRedCount = 0;
                    }

                }, 500)
            }
            function redGreenRed() {
                setInterval(function () {
                    if (redGreenRedCount == 0) {
                        $('[redGreenRed]').attr('src', '../resource/机床图片/红绿.png')
                        redGreenRedCount = 1
                    } else {
                        $('[redGreenRed]').attr('src', '../resource/机床图片/红灰.png')
                        redGreenRedCount = 0;
                    }

                }, 500)
            }
        </script>
</body>
</html>